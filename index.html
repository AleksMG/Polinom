<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¶–∏—Ñ—Ä–æ–≤–æ–π –®–∏—Ñ—Ä–∞—Ç–æ—Ä | Military Grade</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        :root {
            --bg-dark: #0d1117;
            --bg-darker: #161b22;
            --text-light: #c9d1d9;
            --text-lighter: #f0f6fc;
            --border-dark: #30363d;
            --primary: #238636;
            --primary-hover: #2ea043;
            --error: #f85149;
            --success: #3fb950;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: var(--bg-dark);
            color: var(--text-light);
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        h1, h2, h3 {
            color: var(--text-lighter);
        }
        
        .panel {
            background: var(--bg-darker);
            border: 1px solid var(--border-dark);
            border-radius: 6px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        textarea, input, select {
            width: 100%;
            padding: 10px;
            margin: 8px 0;
            background: var(--bg-dark);
            color: var(--text-lighter);
            border: 1px solid var(--border-dark);
            border-radius: 4px;
            font-family: inherit;
        }
        
        textarea {
            min-height: 100px;
            resize: vertical;
        }
        
        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            transition: background 0.2s;
        }
        
        button:hover {
            background: var(--primary-hover);
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            background: var(--bg-dark);
            border-radius: 4px;
            border-left: 3px solid var(--primary);
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .status {
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            display: none;
        }
        
        .success {
            background: rgba(63, 185, 80, 0.1);
            border-left: 3px solid var(--success);
            color: var(--success);
            display: block;
        }
        
        .error {
            background: rgba(248, 81, 73, 0.1);
            border-left: 3px solid var(--error);
            color: var(--error);
            display: block;
        }
        
        .settings {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .settings > * {
            flex: 1;
        }
        
        @media (max-width: 600px) {
            .settings {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üî¢ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ü–∏—Ñ—Ä–æ–≤–æ–π —à–∏—Ñ—Ä–∞—Ç–æ—Ä</h1>
        <p>–®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –≤ —á–∏—Å–ª–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–ª–∏–Ω—ã —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –æ–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å—é</p>
        
        <div class="panel">
            <h2>üîí –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</h2>
            <div class="settings">
                <div>
                    <label for="encrypt-key">–ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è</label>
                    <input type="password" id="encrypt-key" placeholder="–ú–∏–Ω–∏–º—É–º 16 —Å–∏–º–≤–æ–ª–æ–≤">
                </div>
                <div>
                    <label for="number-length">–î–ª–∏–Ω–∞ —á–∏—Å–µ–ª</label>
                    <select id="number-length">
                        <option value="4">4 —Ü–∏—Ñ—Ä—ã</option>
                        <option value="5">5 —Ü–∏—Ñ—Ä</option>
                        <option value="6">6 —Ü–∏—Ñ—Ä</option>
                    </select>
                </div>
            </div>
            
            <label for="plain-text">–¢–µ–∫—Å—Ç –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è</label>
            <textarea id="plain-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç..."></textarea>
            
            <button onclick="encryptText()">–ó–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å</button>
            
            <div class="status" id="encrypt-status"></div>
            
            <div class="result" id="encrypted-result">
                –ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è...
            </div>
        </div>
        
        <div class="panel">
            <h2>üîì –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ</h2>
            <div class="settings">
                <div>
                    <label for="decrypt-key">–ö–ª—é—á –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è</label>
                    <input type="password" id="decrypt-key" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á">
                </div>
                <div>
                    <label for="decrypt-number-length">–î–ª–∏–Ω–∞ —á–∏—Å–µ–ª</label>
                    <select id="decrypt-number-length">
                        <option value="4">4 —Ü–∏—Ñ—Ä—ã</option>
                        <option value="5">5 —Ü–∏—Ñ—Ä</option>
                        <option value="6">6 —Ü–∏—Ñ—Ä</option>
                    </select>
                </div>
            </div>
            
            <label for="cipher-text">–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ —á–∏—Å–ª–∞</label>
            <textarea id="cipher-text" placeholder="–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª..."></textarea>
            
            <button onclick="decryptText()">–î–µ—à–∏—Ñ—Ä–æ–≤–∞—Ç—å</button>
            
            <div class="status" id="decrypt-status"></div>
            
            <div class="result" id="decrypted-result">
                –ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è...
            </div>
        </div>
    </div>

    <script>
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const CONFIG = {
            keyIterations: 100000,
            saltSize: 16, // bytes
            ivSize: 16,   // bytes
            minKeyLength: 16
        };
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ –≤ –º–∞—Å—Å–∏–≤ —á–∏—Å–µ–ª
        function stringToNumbers(str, length) {
            const numbers = [];
            const max = Math.pow(10, length);
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ö–µ—à –¥–ª—è —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
            const hash = CryptoJS.SHA256(str).toString();
            
            for (let i = 0; i < hash.length; i += 4) {
                const chunk = hash.substr(i, 4);
                let num = 0;
                
                // –°–æ–∑–¥–∞–µ–º —á–∏—Å–ª–æ –∏–∑ 4 —Å–∏–º–≤–æ–ª–æ–≤ —Ö–µ—à–∞
                for (let j = 0; j < chunk.length; j++) {
                    num = (num * 256) + chunk.charCodeAt(j);
                }
                
                // –ü—Ä–∏–≤–æ–¥–∏–º –∫ –Ω—É–∂–Ω–æ–π –¥–ª–∏–Ω–µ
                num = num % max;
                numbers.push(num.toString().padStart(length, '0'));
            }
            
            return numbers;
        }
        
        // –û–±—Ä–∞—Ç–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª –≤ —Å—Ç—Ä–æ–∫—É (—É–ø—Ä–æ—â–µ–Ω–Ω–æ–µ)
        function numbersToString(numbers) {
            let result = '';
            for (const num of numbers) {
                const n = parseInt(num, 10);
                result += String.fromCharCode((n >> 8) & 0xFF, n & 0xFF);
            }
            return result;
        }
        
        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
        async function encryptText() {
            try {
                const text = document.getElementById('plain-text').value;
                const key = document.getElementById('encrypt-key').value;
                const length = parseInt(document.getElementById('number-length').value);
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è
                if (!key || key.length < CONFIG.minKeyLength) {
                    throw new Error(`–ö–ª—é—á –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –Ω–µ –º–µ–Ω–µ–µ ${CONFIG.minKeyLength} —Å–∏–º–≤–æ–ª–æ–≤`);
                }
                if (!text) {
                    throw new Error('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è');
                }
                if (length < 4 || length > 6) {
                    throw new Error('–î–ª–∏–Ω–∞ —á–∏—Å–µ–ª –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—Ç 4 –¥–æ 6 —Ü–∏—Ñ—Ä');
                }
                
                // 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–æ–ª–∏ –∏ –∫–ª—é—á–∞
                const salt = CryptoJS.lib.WordArray.random(CONFIG.saltSize);
                const derivedKey = CryptoJS.PBKDF2(key, salt, {
                    keySize: 256/32,
                    iterations: CONFIG.keyIterations
                });
                
                // 2. –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ AES
                const iv = CryptoJS.lib.WordArray.random(CONFIG.ivSize);
                const encrypted = CryptoJS.AES.encrypt(text, derivedKey, {
                    iv: iv,
                    padding: CryptoJS.pad.Pkcs7,
                    mode: CryptoJS.mode.CBC
                });
                
                // 3. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –±–ª–æ–∫–∞
                const binaryData = salt.toString() + iv.toString() + encrypted.toString();
                
                // 4. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ —á–∏—Å–ª–∞
                const numbers = stringToNumbers(binaryData, length);
                
                // –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                document.getElementById('encrypted-result').textContent = numbers.join(' ');
                document.getElementById('cipher-text').value = numbers.join(' ');
                showStatus('–¢–µ–∫—Å—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω!', 'encrypt-status', true);
                
            } catch (error) {
                showStatus('–û—à–∏–±–∫–∞: ' + error.message, 'encrypt-status', false);
                console.error('–û—à–∏–±–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:', error);
            }
        }
        
        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
        async function decryptText() {
            try {
                const ciphertext = document.getElementById('cipher-text').value.trim();
                const key = document.getElementById('decrypt-key').value;
                const length = parseInt(document.getElementById('decrypt-number-length').value);
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è
                if (!key) {
                    throw new Error('–í–≤–µ–¥–∏—Ç–µ –∫–ª—é—á –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è');
                }
                if (!ciphertext) {
                    throw new Error('–í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–∞ –¥–ª—è –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è');
                }
                
                // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤–≤–µ–¥–µ–Ω–Ω—ã—Ö —á–∏—Å–µ–ª –≤ –º–∞—Å—Å–∏–≤
                const numbers = ciphertext.split(/\s+/).filter(n => n.trim() !== '');
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã —á–∏—Å–µ–ª
                for (const num of numbers) {
                    if (num.length !== length) {
                        throw new Error(`–í—Å–µ —á–∏—Å–ª–∞ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –¥–ª–∏–Ω—É ${length} —Ü–∏—Ñ—Ä`);
                    }
                }
                
                // 1. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—É–ø—Ä–æ—â–µ–Ω–Ω–æ–µ)
                const binaryData = numbersToString(numbers);
                
                // 2. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Å–æ–ª–∏, IV –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                const salt = CryptoJS.enc.Hex.parse(binaryData.substr(0, 32));
                const iv = CryptoJS.enc.Hex.parse(binaryData.substr(32, 32));
                const encryptedData = binaryData.substr(64);
                
                // 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞
                const derivedKey = CryptoJS.PBKDF2(key, salt, {
                    keySize: 256/32,
                    iterations: CONFIG.keyIterations
                });
                
                // 4. –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
                const decrypted = CryptoJS.AES.decrypt(
                    { ciphertext: CryptoJS.enc.Base64.parse(encryptedData) },
                    derivedKey,
                    { iv: iv }
                );
                
                const plaintext = decrypted.toString(CryptoJS.enc.Utf8);
                
                if (!plaintext) {
                    throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π –∫–ª—é—á –∏–ª–∏ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ');
                }
                
                // –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                document.getElementById('decrypted-result').textContent = plaintext;
                showStatus('–¢–µ–∫—Å—Ç —É—Å–ø–µ—à–Ω–æ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω!', 'decrypt-status', true);
                
            } catch (error) {
                showStatus('–û—à–∏–±–∫–∞: ' + error.message, 'decrypt-status', false);
                console.error('–û—à–∏–±–∫–∞ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è:', error);
            }
        }
        
        // –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –æ–ø–µ—Ä–∞—Ü–∏–∏
        function showStatus(message, elementId, isSuccess) {
            const element = document.getElementById(elementId);
            element.textContent = message;
            element.className = isSuccess ? 'status success' : 'status error';
            
            // –ê–≤—Ç–æ—Å–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                element.style.opacity = '0';
                setTimeout(() => {
                    element.className = 'status';
                    element.style.opacity = '';
                }, 500);
            }, 5000);
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            document.getElementById('plain-text').value = 'HELLO';
            document.getElementById('encrypt-key').value = 'MySuperSecretKey12345';
            setTimeout(encryptText, 500);
        };
    </script>
</body>
</html>
